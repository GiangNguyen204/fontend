<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <title data-i18n="title">Radiant Trio Store</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- Import Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- CSS t√πy ch·ªânh -->
    <link rel="stylesheet" href="../css/sanpham.css">
</head>
<body>
    <!-- Header c√≥ logo, ch·ªçn ng√¥n ng·ªØ, ch·∫ø ƒë·ªô t·ªëi v√† n√∫t ƒëƒÉng xu·∫•t -->
    <header class="text-white py-4 mb-4 shadow d-flex justify-content-between align-items-center px-4 slide-in-left position-relative"
        style="background-image: url('../img/2.jpg'); background-size: cover; background-position: center;">
        <div class="d-flex align-items-center gap-3">
            <img src="../img/1.png" alt="Logo" style="height: 40px;" class="logo-animated">
        </div>
        <div class="d-flex align-items-center gap-2">
            <!-- N√∫t ƒëi ƒë·∫øn gi·ªè h√†ng -->
            <a href="giohang.html" class="btn btn-outline-light position-relative">
                üõí
                <span class="visually-hidden">Gi·ªè h√†ng</span>
            </a>
            <!-- Ch·ªçn ng√¥n ng·ªØ -->
            <select id="languageSelect" class="form-select form-select-sm">
                <option value="vi">VI</option>
                <option value="en">EN</option>
            </select>
            <!-- N√∫t chuy·ªÉn ch·∫ø ƒë·ªô t·ªëi/s√°ng -->
            <button id="toggleDarkMode" class="btn btn-outline-light">
                üåô <span class="d-none"></span>
            </button>
            <!-- N√∫t ƒëƒÉng xu·∫•t -->
            <button id="logoutBtn" class="btn btn-danger">ƒêƒÉng xu·∫•t</button>
        </div>
    </header>

    <div class="container mb-5">
        <!-- Form th√™m/s·ª≠a s·∫£n ph·∫©m -->
        <div class="card shadow-sm mb-4 fade-in">
            <div class="card-body">
                <form id="productForm" class="row g-3">
                    <input type="hidden" id="productId">
                    <div class="col-md-3">
                        <!-- Nh·∫≠p t√™n s·∫£n ph·∫©m -->
                        <input type="text" class="form-control" id="ten" placeholder="T√™n s·∫£n ph·∫©m" required data-i18n-placeholder="name">
                    </div>
                    <div class="col-md-3">
                        <!-- Nh·∫≠p m√¥ t·∫£ -->
                        <input type="text" class="form-control" id="mota" placeholder="M√¥ t·∫£" required data-i18n-placeholder="description">
                    </div>
                    <div class="col-md-2">
                        <!-- Nh·∫≠p gi√° -->
                        <input type="number" class="form-control" id="gia" placeholder="Gi√°" required data-i18n-placeholder="price">
                    </div>
                    <div class="col-md-3">
                        <!-- Nh·∫≠p URL h√¨nh ·∫£nh -->
                        <input type="text" class="form-control" id="hinhanh" placeholder="URL h√¨nh ·∫£nh" required data-i18n-placeholder="image_url">
                    </div>
                    <div class="col-md-1 d-grid">
                        <!-- N√∫t l∆∞u -->
                        <button type="submit" class="btn btn-success" data-i18n="save">L∆∞u</button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Form t√¨m ki·∫øm v√† l·ªçc s·∫£n ph·∫©m -->
        <div class="card shadow-sm mb-4 fade-in">
            <div class="card-body">
                <div class="row g-3">
                    <div class="col-md-4">
                        <!-- T√¨m theo t√™n -->
                        <input type="text" id="searchInput" class="form-control" placeholder="T√¨m theo t√™n s·∫£n ph·∫©m..." data-i18n-placeholder="search_name">
                    </div>
                    <div class="col-md-3">
                        <!-- Gi√° th·∫•p nh·∫•t -->
                        <input type="number" id="minPrice" class="form-control" placeholder="Gi√° th·∫•p nh·∫•t" data-i18n-placeholder="min_price">
                    </div>
                    <div class="col-md-3">
                        <!-- Gi√° cao nh·∫•t -->
                        <input type="number" id="maxPrice" class="form-control" placeholder="Gi√° cao nh·∫•t" data-i18n-placeholder="max_price">
                    </div>
                    <div class="col-md-2 d-grid">
                        <!-- N√∫t l·ªçc -->
                        <button type="button" class="btn btn-outline-primary" onclick="applyFilters(event)" data-i18n="filter">L·ªçc</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Danh s√°ch s·∫£n ph·∫©m (hi·ªÉn th·ªã b·∫±ng JS) -->
        <div class="row row-cols-1 row-cols-md-3 g-4" id="productList"></div>
    </div>

    <!-- Footer -->
    <footer class="bg-white text-center text-muted py-3 border-top footer-slide-in">
        <span data-i18n="footer">&copy; 2025 Ph√°t tri·ªÉn b·ªüi Radiant Trio</span>
    </footer>

    <!-- Modal ch·ªçn s·ªë l∆∞·ª£ng khi th√™m v√†o gi·ªè h√†ng -->
    <div class="modal fade" id="quantityModal" tabindex="-1" aria-labelledby="quantityModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="quantityModalLabel">Ch·ªçn s·ªë l∆∞·ª£ng</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="ƒê√≥ng"></button>
                </div>
                <div class="modal-body">
                    <!-- Nh·∫≠p s·ªë l∆∞·ª£ng -->
                    <input type="number" id="quantityInput" class="form-control" min="1" value="1">
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">H·ªßy</button>
                    <button type="button" class="btn btn-primary" id="saveQuantityButton">ƒê·ªìng √Ω</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Script x·ª≠ l√Ω logic ng√¥n ng·ªØ, gi·ªè h√†ng, ƒëƒÉng xu·∫•t, ch·∫ø ƒë·ªô t·ªëi/s√°ng -->
    <script>
        // X·ª≠ l√Ω ch·∫ø ƒë·ªô t·ªëi/s√°ng
        const toggleBtn = document.getElementById("toggleDarkMode");
        const body = document.body;

        if (localStorage.getItem("darkMode") === "true") {
            body.classList.add("dark-mode");
            toggleBtn.querySelector("span").textContent = "Ch·∫ø ƒë·ªô s√°ng";
        }

        toggleBtn.addEventListener("click", () => {
            body.classList.toggle("dark-mode");
            const isDark = body.classList.contains("dark-mode");
            localStorage.setItem("darkMode", isDark);
            toggleBtn.querySelector("span").textContent = isDark ? translations[currentLang]["light_mode"] : translations[currentLang]["dark_mode"];
        });

        // ƒêa ng√¥n ng·ªØ: ti·∫øng Vi·ªát v√† ti·∫øng Anh
        const translations = {
            vi: { ... },
            en: { ... }
        };

        let currentLang = localStorage.getItem("lang") || "vi";
        document.getElementById("languageSelect").value = currentLang;

        function updateLanguage(lang) {
            currentLang = lang;
            localStorage.setItem("lang", lang);
            document.querySelectorAll("[data-i18n]").forEach(el => {
                const key = el.getAttribute("data-i18n");
                if (translations[lang][key]) el.textContent = translations[lang][key];
            });
            document.querySelectorAll("[data-i18n-placeholder]").forEach(el => {
                const key = el.getAttribute("data-i18n-placeholder");
                if (translations[lang][key]) el.placeholder = translations[lang][key];
            });
            toggleBtn.querySelector("span").textContent = body.classList.contains("dark-mode")
                ? translations[lang]["light_mode"]
                : translations[lang]["dark_mode"];
        }

        // ƒê·ªïi ng√¥n ng·ªØ khi ch·ªçn
        document.getElementById("languageSelect").addEventListener("change", (e) => {
            updateLanguage(e.target.value);
        });

        updateLanguage(currentLang);

        // N√∫t ƒëƒÉng xu·∫•t
        document.getElementById("logoutBtn").addEventListener("click", () => {
            localStorage.removeItem("user");
            alert(currentLang === "vi" ? "B·∫°n ƒë√£ ƒëƒÉng xu·∫•t." : "You have logged out.");
            window.location.href = "dangnhap.html";
        });

        // X·ª≠ l√Ω th√™m v√†o gi·ªè h√†ng
        let selectedProductForCart = null;

        document.addEventListener("click", function (e) {
            if (e.target.classList.contains("add-to-cart-btn")) {
                const productCard = e.target.closest(".product-card");
                selectedProductForCart = {
                    id: e.target.dataset.id,
                    ten: productCard.querySelector(".product-name").textContent,
                    mota: productCard.querySelector(".product-description").textContent,
                    gia: parseInt(productCard.querySelector(".product-price").dataset.price),
                    hinhanh: productCard.querySelector("img").src
                };
                const modal = new bootstrap.Modal(document.getElementById("quantityModal"));
                modal.show();
            }
        });

        // L∆∞u s·ªë l∆∞·ª£ng s·∫£n ph·∫©m v√†o gi·ªè
        document.getElementById("saveQuantityButton").addEventListener("click", () => {
            const quantity = parseInt(document.getElementById("quantityInput").value) || 1;
            if (!selectedProductForCart) return;
            selectedProductForCart.soluong = quantity;

            let cart = JSON.parse(localStorage.getItem("cart")) || [];
            const existing = cart.find(item => item.id == selectedProductForCart.id);
            if (existing) {
                existing.soluong += quantity;
            } else {
                cart.push(selectedProductForCart);
            }
            localStorage.setItem("cart", JSON.stringify(cart));

            const modal = bootstrap.Modal.getInstance(document.getElementById("quantityModal"));
            modal.hide();
            alert("ƒê√£ th√™m v√†o gi·ªè h√†ng v·ªõi s·ªë l∆∞·ª£ng: " + quantity);
        });
    </script>

    <!-- Bootstrap Bundle JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
